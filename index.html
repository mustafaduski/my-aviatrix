<!DOCTYPE html>
<html lang="ku">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aviatrix Master Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; background: #050a14; color: white; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; transition: 0.1s; }
        .top-bar { padding: 15px; background: #111; display: flex; justify-content: space-between; border-bottom: 2px solid #00ff88; }
        .game-zone { flex: 1; display: flex; justify-content: center; align-items: center; position: relative; overflow: hidden; }
        #multi { font-size: 60px; font-weight: 900; color: #00ff88; z-index: 2; }
        #plane { position: absolute; font-size: 50px; bottom: 20%; left: 10%; transition: transform 0.1s linear; display: none; }
        .controls { padding: 30px; background: #111; border-radius: 25px 25px 0 0; display: flex; flex-direction: column; align-items: center; }
        .btn { width: 100%; padding: 20px; font-size: 24px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer; }
        .btn-bet { background: #00ff88; color: black; }
        .btn-cash { background: #ffaa00; color: black; }
        input { width: 80px; padding: 10px; margin-bottom: 10px; border-radius: 8px; text-align: center; font-size: 18px; }

        /* لەرینەوەی شاشە کاتی دۆڕان */
        @keyframes shake {
            0% { transform: translate(2px, 2px); }
            25% { transform: translate(-2px, -2px); }
            50% { transform: translate(2px, -2px); }
            75% { transform: translate(-2px, 2px); }
            100% { transform: translate(0, 0); }
        }
        .shaking { animation: shake 0.1s infinite; background: #2a0505; }
    </style>
</head>
<body>

<div class="top-bar">
    <div id="u-name">...</div>
    <div>$ <span id="u-balance">100.00</span></div>
</div>

<div class="game-zone" id="main-screen">
    <div id="plane">✈️</div>
    <div id="multi">1.00x</div>
</div>

<div class="controls">
    <input type="number" id="bet-val" value="10">
    <button id="main-btn" class="btn btn-bet">BET</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let balance = parseFloat(localStorage.getItem('bal')) || 100.00;
    let m = 1.00;
    let active = false;
    let timer;

    const bDisp = document.getElementById('u-balance');
    const mDisp = document.getElementById('multi');
    const plane = document.getElementById('plane');
    const btn = document.getElementById('main-btn');
    const bVal = document.getElementById('bet-val');
    const body = document.body;

    document.getElementById('u-name').innerText = tg.initDataUnsafe?.user?.first_name || "Yarizan";
    updateUI();

    btn.onclick = () => {
        if (!active) {
            let b = parseFloat(bVal.value);
            if (b <= balance && b > 0) {
                balance -= b;
                active = true;
                m = 1.00;
                btn.innerText = "CASH OUT";
                btn.className = "btn btn-cash";
                mDisp.style.color = "#00ff88";
                plane.style.display = "block";
                updateUI();
                
                timer = setInterval(() => {
                    m += 0.02;
                    mDisp.innerText = m.toFixed(2) + "x";
                    let moveX = (m - 1) * 40;
                    let moveY = (m - 1) * -25;
                    plane.style.transform = `translate(${moveX}px, ${moveY}px)`;

                    if (Math.random() < 0.032) crash();
                }, 60);
            }
        } else {
            balance += parseFloat(bVal.value) * m;
            stop();
        }
    };

    function crash() {
        active = false;
        clearInterval(timer);
        mDisp.innerText = "CRASHED!";
        mDisp.style.color = "#ff4444";
        plane.style.display = "none";
        
        // ئەنجامدانی لەرینەوەی شاشە
        body.classList.add('shaking');
        setTimeout(() => { body.classList.remove('shaking'); }, 500);

        btn.innerText = "BET";
        btn.className = "btn btn-bet";
        localStorage.setItem('bal', balance);
        updateUI();
    }

    function stop() {
        active = false;
        clearInterval(timer);
        btn.innerText = "BET";
        btn.className = "btn btn-bet";
        localStorage.setItem('bal', balance);
        updateUI();
        plane.style.display = "none";
    }

    function updateUI() {
        bDisp.innerText = balance.toFixed(2);
    }
</script>
</body>
</html>
